<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡πÄ‡∏Å‡∏°‡∏†‡∏≤‡∏©‡∏µ 7%</title>
  <style>
    body { font-family: 'Sarabun', sans-serif; text-align: center; padding: 20px; }
    input, button { padding: 10px; font-size: 16px; margin: 5px; }
    #gameArea, #endArea { display: none; }
    #timer { font-weight: bold; color: red; }
    table { margin: 20px auto; border-collapse: collapse; }
    th, td { border: 1px solid #999; padding: 6px 10px; }
    .correct { color: green; font-weight: bold; }
    .wrong { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° -->
  <div id="startArea">
    <h1>üéÆ ‡πÄ‡∏Å‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏©‡∏µ 7%</h1>
    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</p>
    <input type="text" id="playerName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô">
    <br>
    <button onclick="startGame()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
  </div>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡πà‡∏ô -->
  <div id="gameArea">
    <h2>‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà <span id="questionNumber">1</span> / 10</h2>
    <p id="questionText">‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: </p>
    <p id="timer">‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤: 15</p>
    <input type="number" id="answer" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ">
    <br>
    <button onclick="submitAnswer()">‡∏ï‡∏≠‡∏ö</button>
    <p id="feedback"></p>
    <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="score">0</span></p>
  </div>

  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏ö -->
  <div id="endArea">
    <h2>‚úÖ ‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß!</h2>
    <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: <span id="finalScore"></span> / 10</p>
    <h3>üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</h3>
    <div id="leaderboard"></div>
  </div>

  <!-- ‡πÄ‡∏™‡∏µ‡∏¢‡∏á -->
  <audio id="soundCorrect" src="https://www.soundjay.com/buttons/sounds/button-4.mp3"></audio>
  <audio id="soundWrong" src="https://www.soundjay.com/buttons/sounds/button-10.mp3"></audio>
  <audio id="soundTimeout" src="https://www.soundjay.com/button/beep-07.mp3"></audio>

  <script>
    let playerName = "";
    let questionCount = 0;
    let score = 0;
    let currentPrice = 0;
    let timer, timeLeft = 15;

    function startGame() {
      const nameInput = document.getElementById("playerName").value.trim();
      if (!nameInput) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°");
      playerName = nameInput;
      questionCount = 0;
      score = 0;
      document.getElementById("score").innerText = score;
      document.getElementById("startArea").style.display = "none";
      document.getElementById("gameArea").style.display = "block";
      nextQuestion();
    }

    function nextQuestion() {
      if (questionCount >= 10) return endGame();
      questionCount++;
      document.getElementById("questionNumber").innerText = questionCount;
      currentPrice = Math.floor(Math.random() * 901 + 100); // 100-1000
      document.getElementById("questionText").innerText = `‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: ${currentPrice} ‡∏ö‡∏≤‡∏ó (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏†‡∏≤‡∏©‡∏µ)`;
      document.getElementById("answer").value = "";
      document.getElementById("feedback").innerText = "";

      // ‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà
      clearInterval(timer);
      timeLeft = 15;
      document.getElementById("timer").innerText = `‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤: ${timeLeft}`;
      timer = setInterval(countdown, 1000);
    }

    function countdown() {
      timeLeft--;
      document.getElementById("timer").innerText = `‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤: ${timeLeft}`;
      if (timeLeft <= 0) {
        clearInterval(timer);
        document.getElementById("feedback").innerHTML = `<span class="wrong">‚åõ ‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!</span>`;
        document.getElementById("soundTimeout").play();
        setTimeout(nextQuestion, 1500);
      }
    }

    function submitAnswer() {
      if (timeLeft <= 0) return; // ‡∏Å‡∏î‡∏´‡∏•‡∏±‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏¥‡∏î

      clearInterval(timer);
      const userAnswer = parseFloat(document.getElementById("answer").value);
      const correctAnswer = +(currentPrice * 1.07).toFixed(2);

      if (Math.abs(userAnswer - correctAnswer) < 0.01) {
        score++;
        document.getElementById("feedback").innerHTML = `<span class="correct">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</span><br>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏¥‡∏î: ${currentPrice} √ó 1.07 = ${correctAnswer}`;
        document.getElementById("soundCorrect").play();
      } else {
        document.getElementById("feedback").innerHTML = `<span class="wrong">‚ùå ‡∏ú‡∏¥‡∏î!</span><br>‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏∑‡∏≠ ${correctAnswer}<br>‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏¥‡∏î: ${currentPrice} √ó 1.07 = ${correctAnswer}`;
        document.getElementById("soundWrong").play();
      }

      document.getElementById("score").innerText = score;
      setTimeout(nextQuestion, 2500);
    }

    function endGame() {
      document.getElementById("gameArea").style.display = "none";
      document.getElementById("endArea").style.display = "block";
      document.getElementById("finalScore").innerText = score;

      const oldData = JSON.parse(localStorage.getItem("vatLeaderboard") || "[]");
      oldData.push({ name: playerName, score });
      oldData.sort((a, b) => b.score - a.score);
      localStorage.setItem("vatLeaderboard", JSON.stringify(oldData.slice(0, 10)));

      showLeaderboard();

      // ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
      setTimeout(() => {
        document.getElementById("endArea").style.display = "none";
        document.getElementById("startArea").style.display = "block";
        document.getElementById("playerName").value = "";
      }, 8000);
    }

    function showLeaderboard() {
      const data = JSON.parse(localStorage.getItem("vatLeaderboard") || "[]");
      let html = "<table><tr><th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th></tr>";
      data.forEach((item, index) => {
        html += `<tr><td>${index + 1}</td><td>${item.name}</td><td>${item.score}</td></tr>`;
      });
      html += "</table>";
      document.getElementById("leaderboard").innerHTML = html;
    }
  </script>

</body>
</html>
